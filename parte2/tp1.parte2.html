<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>TP1 - parte 2</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>TP1 - parte 2</h1>

<h2>Tarea 1</h2>

<p>Aplicamos los pasos de la parte 1.</p>

<pre><code class="r">glx_0 &lt;- read.csv(&quot;dataset.procesado.parte.1.csv&quot;, header = T, stringsAsFactors = F)
head(glx_0, 1)
</code></pre>

<pre><code>##   nr   rmag            apdrmag   mcz  ujmag  bjmag  vjmag  usmag gsmag
## 1  6 24.995 0.9350000000000001 0.832 -17.67 -17.54 -17.76 -17.83 -17.6
##    rsmag  ubmag  bbmag  vbmag s280mag
## 1 -17.97 -17.76 -17.53 -17.76  -18.22
</code></pre>

<p>Analizamos agrupamientos usando k-medias. Pasos:</p>

<ul>
<li>Quitamos variables correlacionadas</li>
</ul>

<p>Las variables que tienen índice de correlación 1, según los resultados de la parte 1, son:</p>

<pre><code class="r"># (ujmag, usmag, ubmag)
# (bjmag, bbmag)
# (vjmag, rsmag, vnmag)
</code></pre>

<p>Se trata, obviamente, de los grupos de magnitudes medidas en una misma banda. Nos quedamos con 1 variable que represente a cada grupo:</p>

<pre><code class="r">glx_1 &lt;- glx_0[,c(1:7)]
</code></pre>

<ul>
<li>Estandarizamos variables</li>
</ul>

<pre><code class="r"># sólo estandarizamos variables con mediciones (sin la primera columna, porque es el número de galaxia)
glx_2 &lt;- scale(glx_1[,c(2:7)])
head(glx_2, 1)
</code></pre>

<pre><code>##                    rmag           apdrmag                mcz
## [1,] 0.7481409363139495 2.530149066971338 0.3218825827357346
##                   ujmag              bjmag              vjmag
## [1,] 0.1184136486227584 0.1237063466556295 0.1841887849416674
</code></pre>

<ul>
<li><p>Determinamos el <code>k</code> óptimo para K-means:</p></li>
<li><p>Gráficamente</p></li>
</ul>

<p>Podemos ver el <code>k</code> óptimo como el punto de corte en que deja de disminuir marcadamente la suma de cuadrados dentro del cluster. En otras palabras, el punto en que la cohesión de los clusters deja de aumentar.</p>

<pre><code class="r">wssplot &lt;- function(data, nc=15, seed=1234){wss &lt;- (nrow(data)-1)*sum(apply(data,2,var))
               for (i in 2:nc){
                    set.seed(seed)
                    wss[i] &lt;- sum(kmeans(data, centers=i)$withinss)}
                plot(1:nc, wss, type=&quot;b&quot;, xlab=&quot;Número de clusters&quot;,
                     ylab=&quot;Suma de cuadrados dentro del cluster&quot;)}

wssplot(glx_2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-7"/> </p>

<p>El gráfico sugiere usar <code>k</code> = 2 ó 3 (es discutible).</p>

<ul>
<li>Analíticamente</li>
</ul>

<p>Calculamos una matrix de distancias:</p>

<pre><code class="r">library(cluster)
glx_2_dist &lt;- dist(glx_2)
</code></pre>

<p>Usamos la matriz de distancias con <code>kmeans</code>:</p>

<pre><code class="r"># una función que, dado un k, clusteriza por kmeans -&gt; calcula silhouette -&gt; devuelve ancho promedio
silhoutte_kmeans &lt;- function(k) {
  c &lt;- kmeans(glx_2, centers = k)$cluster
  s &lt;- silhouette(c, glx_2_dist)
  return(summary(s)$avg.width)
}

# aplicamos la función para valores de k entre 2 y 10
indice_por_k_kmeans &lt;- sapply(c(2:10), silhoutte_kmeans)
which.max(indice_por_k_kmeans)
</code></pre>

<pre><code>## [1] 1
</code></pre>

<p>El <code>k</code> que maximiza el ancho promedio de silhouette para todos los clusters creados via K-means es el primero =&gt; <code>k</code> = 2.</p>

<p>Hay 2 grupos. Leyendo un poco la descripción del dataset, una interpretación posible es que los grupos representen galaxias &#39;azules&#39; y &#39;rojas&#39;; en otras palabras, que los grupos dependen del corrimiento al rojo. Si lo ploteamos, las medias difieren bastante:</p>

<pre><code class="r">k2 &lt;- kmeans(glx_2, centers = 2)
boxplot(glx_1$mcz ~ k2$cluster, col=c(&quot;red&quot;, &quot;blue&quot;))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-10"/> </p>

<p>Éstos son los centros de cada cluster (revirtiendo a las medidas originales). Se ve que el redshift mayor o menor que 0 divide a los grupos:</p>

<pre><code class="r">aggregate(glx_2, by = list(k2$cluster), mean)
</code></pre>

<pre><code>##   Group.1                  rmag               apdrmag                mcz
## 1       1  0.005773528295152889 -0.009751884029828599  0.317479333145156
## 2       2 -0.030731788065529994  0.051908091191984349 -1.689903830486670
##                 ujmag               bjmag               vjmag
## 1 -0.3471593365751252 -0.3401438286077606 -0.3361592806310137
## 2  1.8478868745742363  1.8105441799509021  1.7893349162739356
</code></pre>

<h2>Tarea 1 (optativa): Comparar métodos</h2>

<p>Ahora usamos PAM en lugar de K-means:</p>

<pre><code class="r"># una función que, dado un k, clusteriza por PAM -&gt; calcula silhouette -&gt; devuelve ancho promedio
silhoutte_pam &lt;- function(k) {
  c &lt;- pam(glx_2_dist, k=k, diss=T)
  s &lt;- silhouette(c)
  return(summary(s)$avg.width)
}

# aplicamos la función para valores de k entre 2 y 5
indice_por_k_pam &lt;- sapply(c(2:5), silhoutte_pam)
which.max(indice_por_k_pam)
</code></pre>

<pre><code>## [1] 1
</code></pre>

<p>El <code>k</code> que maximiza el ancho promedio de silhouette para todos los clusters creados via PAM es el primero =&gt; <code>k</code> = 2.</p>

<p>Ventajas de PAM sobre K-means:</p>

<ul>
<li>es más robusto ante la presencia de outliers (porque la mediana es más robusta que la media);</li>
<li>se puede usar cualquier medida de similitud;</li>
<li>como usa medoides, encuentra objetos representativos del cluster =&gt; el resultado se puede interpretar mejor estudiando las propiedades de un objeto particular.</li>
</ul>

<p>Principal desventaja de PAM ante K-means:</p>

<ul>
<li>es más lento, porque tiene una complejidad del orden de O(n<sup>2</sup> * k * i) (donde n = cantidad de objetos, k = cantidad de medoides, i = iteraciones). K-means, en cambio, tiene una complejidad de O(n * k * i) (evita el término cuadrático porque sólo tiene que calcular distancias de los objetos a los centroides).</li>
</ul>

<p>También podemos probar otra biblioteca para clusterizar maximizando el índice de Silhouette:</p>

<pre><code class="r">library(NbClust)
set.seed(1234)
nc &lt;- NbClust(glx_2, min.nc = 2, max.nc = 5, method = &quot;kmeans&quot;, index = &quot;silhouette&quot;)
nc$Best.nc
</code></pre>

<pre><code>## Number_clusters     Value_Index 
##          2.0000          0.4915
</code></pre>

<p>Este método también sugiere usar <code>k</code> = 2.</p>

<h2>Tarea 2</h2>

<p>Cargamos el dataset entero (partimos de un .csv que fue creado a partir del dataset original descargado del website y parseado según las instrucciones para cada campo):</p>

<pre><code class="r">glx &lt;- read.csv(&quot;dmcyt_tp2.csv&quot;, header = T, stringsAsFactors = F, sep = &#39;|&#39;)
glx$mc_class &lt;- as.factor(glx$mc_class)

# evitemos que R trunque decimales
options(digits=16)
</code></pre>

<p>Quitamos outliers:</p>

<pre><code class="r">glx_sin_outliers &lt;- subset(glx, apd_rmag &gt; -3.2)
glx_sin_outliers &lt;- subset(glx_sin_outliers, bjmag &lt; -7.0)
glx_sin_outliers &lt;- subset(glx_sin_outliers, ujmag &lt; -10.0)
glx_sin_outliers &lt;- subset(glx_sin_outliers, vjmag &lt; -10.0)
glx_sin_outliers &lt;- subset(glx_sin_outliers, usmag &lt; -10.0)
glx_sin_outliers &lt;- subset(glx_sin_outliers, gsmag &lt; -9.0)
glx_sin_outliers &lt;- subset(glx_sin_outliers, rsmag &lt; -9.0)
# glx_sin_outliers &lt;- subset(glx_sin_outliers, bbmag &lt; -9.0) # todos los valores en 0?
# glx_sin_outliers &lt;- subset(glx_sin_outliers, ubmag &lt; -10.0) # todos los valores en 0?
# glx_sin_outliers &lt;- subset(glx_sin_outliers, vbmag &lt; -10.0) # todos los valores en 0? (antes era vnmag)

nrow(glx) - nrow(glx_sin_outliers)
</code></pre>

<pre><code>## [1] 8181
</code></pre>

<p>Buscamos datos faltantes:</p>

<pre><code class="r">glx_sin_faltantes &lt;- glx_sin_outliers[complete.cases(glx_sin_outliers),]
nrow(glx_sin_outliers) - nrow(glx_sin_faltantes)
</code></pre>

<pre><code>## [1] 720
</code></pre>

<p>Dimensiones del dataset final:</p>

<pre><code class="r">dim(glx_sin_faltantes)
</code></pre>

<pre><code>## [1] 54600    26
</code></pre>

<h2>Tarea 3</h2>

<p>Extraemos las variables que tienen mediciones para poder encontrar clusters:</p>

<pre><code class="r">glx_tarea3.0 &lt;- glx_sin_faltantes[,c(11,13,17,18,19)]
</code></pre>

<p>Ahora calculamos distancias para correr PAM y después Silhouette:</p>

<pre><code class="r">glx_tarea3.1 &lt;- dist(scale(glx_tarea3.0))
</code></pre>

<pre><code>## Error in dist(scale(glx_tarea3.0)): negative length vectors are not allowed
</code></pre>

<p>Pinchó. ¿Por qué?</p>

<p>Calcular la matriz de distancias implica que, por cada elemento de la matriz, hay que calcular la distancia a todos los demás elementos. Es decir, es un procedimiento cuadrático: si la matriz tiene <code>n</code> elementos, hay que almacenar <code>n x n</code> distancias.</p>

<p>Se puede deducir, para el caso de la implementación de R, dónde está el problema de alocación de memoria:</p>

<pre><code class="r"># tomamos las primeras 16000 filas
glx_muestra_16k &lt;- glx_sin_faltantes[c(1:16000), c(11,13,17,18,19)]

# intentamos calcular la matriz, y la imprimimos para forzarlo a que nos devuelve un mensaje de error
dist(scale(glx_muestra_16k))
</code></pre>

<pre><code>## Error: cannot allocate vector of size 1.9 Gb
</code></pre>

<p>Por el mensaje de error, vemos que no puede alocar espacio (0.975 Gb). Entonces podemos despejar la cantidad de bytes que usa para guardar distancias:</p>

<pre><code class="r">0.975 * (1024)^3 / (16000^2)
</code></pre>

<pre><code>## [1] 4.0894464
</code></pre>

<p>Son 4 bytes. Usando apenas 4 bytes para almacenar distancias, el cálculo para una matriz de tamaño modesto se vuelve demasiado costoso, rápidamente.</p>

<p>Podemos probar de nuevo restringiendo el tamaño del dataset (y limpiando un poco con gc()).</p>

<pre><code>##            used  (Mb) gc trigger   (Mb)  max used   (Mb)
## Ncells   389795  10.5     750400   20.1    750400   20.1
## Vcells 67755130 517.0  188229511 1436.1 195853105 1494.3
</code></pre>

<p>Tomamos una muestra de 10000 objetos (en la compu donde corre esto, si tomamos más de 15000 pincha). Agrupamos con K-means buscando el <code>k</code> óptimo:</p>

<pre><code class="r">filas_muestra &lt;- sample(nrow(glx_sin_faltantes), size = 10000)
glx_muestra_10k &lt;- glx_sin_faltantes[filas_muestra,]
glx_muestra_10k_mediciones &lt;- glx_muestra_10k[,c(11,13,16,17,18,19)]
head(glx_muestra_10k_mediciones, 1)
</code></pre>

<pre><code>##         rmag ap_rmag  mc_z  ujmag  bjmag  vjmag
## 31278 24.193  24.278 0.965 -19.02 -18.93 -19.11
</code></pre>

<pre><code class="r">glx_muestra_10k_dist &lt;- dist(scale(glx_muestra_10k_mediciones))

silhoutte_kmeans &lt;- function(k) {
  c &lt;- kmeans(glx_muestra_10k_mediciones, centers = k)$cluster
  s &lt;- silhouette(c, glx_muestra_10k_dist)
  return(summary(s)$avg.width)
}

# aplicamos la función para valores de k entre 2 y 5
indice_por_k_kmeans &lt;- sapply(c(2:5), silhoutte_kmeans)
which.max(indice_por_k_kmeans)
</code></pre>

<pre><code>## [1] 1
</code></pre>

<p>Obtenemos el primer k, o sea <code>k</code> = 2.</p>

<p>(Sería interesante investigar si el &ldquo;valle verde&rdquo; que está entre las galaxias rojas y la nube de galaxias azules en el gráfico de color-magnitud aparecería ampliando la muestra&hellip;)</p>

</body>

</html>
